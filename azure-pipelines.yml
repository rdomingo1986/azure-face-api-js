# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- script: 'npm install'
  displayName: 'Install'
  
#- script: 'npm run ts-test'
#  displayName: 'Test'

- script: 'npm run compile'
  displayName: 'Compile'

- task: ArchiveFiles@2
  inputs:
    rootFolderOrFile: './dist'
    includeRootFolder: true
    archiveType: 'zip'
    archiveFile: './dist/$(Build.BuildId).zip'
    replaceExistingArchive: true

- task: AzureFileCopy@3
  inputs:
    SourcePath: './dist/$(Build.BuildId).zip'
    azureSubscription: 'Visual Studio Enterprise (1c86dc94-8e3e-4987-9835-1e8fa91876a9)'
    Destination: 'AzureBlob'
    storage: 'rdomingo1986'
    ContainerName: 'dbbackups'